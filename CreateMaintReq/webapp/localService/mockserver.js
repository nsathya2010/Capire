/*
 * Copyright (C) 2009-2022 SAP SE or an SAP affiliate company. All rights reserved.
 */
sap.ui.define(["sap/ui/core/util/MockServer"],function(M){"use strict";var m,_="orion/maintreq/manage/",a=_+"localService/mockdata",b="C_MaintWorkRequestOverviewTP.json";var E=["C_MaintWorkRequestOverviewTP","C_MaintWorkRequestDamageCodeVH","C_TechObjFlatVH","C_WorkReqTextTemplateVH","I_DraftAdministrativeData","I_MalfunctionEffectStdVH","I_PMNotificationPriority"];return{_getResponseJson:function(e){return jQuery.sap.sjax({url:jQuery.sap.getModulePath(a)+"/"+e,dataType:"json"});},init:function(){var u=jQuery.sap.getUriParameters(),j=jQuery.sap.getModulePath(a),s=jQuery.sap.getModulePath(_+"manifest",".json"),e="C_MaintWorkRequestOverviewTP",c=u.get("errorType"),i=c==="badRequest"?400:500,o=jQuery.sap.syncGetJSON(s).data,d=o["sap.app"].dataSources,f=d.mainService,g=jQuery.sap.getModulePath(_+f.settings.localUri.replace(".xml",""),".xml"),h=/.*\/$/.test(f.uri)?f.uri:f.uri+"/",A=f.settings.annotations;m=new M({rootUri:h});M.config({autoRespond:true,autoRespondAfter:u.get("serverDelay")||1000});m.simulate(g,{sMockdataBaseUrl:j,bGenerateMissingMockData:true,aEntitySetsNames:E});var r=m.getRequests(),R=function(l,n,p){p.response=function(x){x.respond(l,{"Content-Type":"text/plain;charset=utf-8"},n);};};r.push({method:"POST",path:new RegExp("C_MaintWorkRequestOverviewTPPrepare.*"),response:function(x){var l={data:{C_MaintWorkRequestOverviewTPPrepare:{__metadata:{type:"cds_ui_maintworkrequestoverview.DummyFunctionImportResult"},IsInvalid:false}},headers:{"Content-Type":"application/json"},status:"200",statusText:"OK"};x.respond(l.status,l.headers,JSON.stringify({d:l.data}));}});var k=this._getResponseJson(b);r.push({method:"POST",path:new RegExp("C_MaintWorkRequestOverviewTPActivate.*"),response:function(x){jQuery.sap.log.debug("Mock Server: Incoming request for external resource");var l={data:k.data[5],headers:{"Content-Type":"application/json","sap-message":JSON.stringify({code:"EAMS_BO/502",message:"Work request 10094460 saved.",severity:"success",target:"",transition:true,details:[]}),location:"/C_MaintWorkRequestOverviewTP(MaintenanceNotification='%2500000000001',DraftUUID=guid'00000000-0000-0000-0000-000000000000',IsActiveEntity=true)"},status:"200",statusText:"OK"};x.respond(l.status,l.headers,JSON.stringify({d:l.data}));return true;}});r.push({method:"POST",path:new RegExp("C_MaintWorkRequestOverviewTP"),response:function(x){jQuery.sap.log.debug("Mock Server: Incoming request for external resource");var l={data:k.data[0],headers:{"Content-Type":"application/json",location:k.data[0].__metadata.uri},status:"201",statusText:"Created"};x.respond(l.status,l.headers,JSON.stringify({d:l.data}));return true;}});r.push({method:"MERGE",path:new RegExp("C_MaintWorkRequestOverviewTP.*"),response:function(x){jQuery.sap.log.debug("Mock Server: Incoming request for external resource");var l={headers:{},status:"204",statusText:"No Content"};x.respond(l.status,l.headers);return true;}});m.setRequests(r);if(u.get("metadataError")){r.forEach(function(l){if(l.path.toString().indexOf("$metadata")>-1){R(500,"metadata Error",l);}});}if(c){r.forEach(function(l){if(l.path.toString().indexOf(e)>-1){R(i,c,l);}});}m.start();jQuery.sap.log.info("Running the app with mock data");if(A&&A.length>0){A.forEach(function(l){var n=d[l],U=n.uri,L=jQuery.sap.getModulePath(_+n.settings.localUri.replace(".xml",""),".xml");new M({rootUri:U,requests:[{method:"GET",path:new RegExp("([?#].*)?"),response:function(x){jQuery.sap.require("jquery.sap.xml");var p=jQuery.sap.sjax({url:L,dataType:"xml"}).data;x.respondXML(200,{},jQuery.sap.serializeXML(p));return true;}}]}).start();});}this._createMockServerForOtherServices();},_createMockServerForOtherServices:function(){new M({rootUri:"/sap/opu/odata/SAP/CA_FM_FEATURE_TOGGLE_STATUS_SRV/",requests:[{method:"GET",path:new RegExp(".*"),response:function(x){x.respondJSON(200,{},{d:{results:[]}});return true;}}]}).start();},getMockServer:function(){return m;}};});
